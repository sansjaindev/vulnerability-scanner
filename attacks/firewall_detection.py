import subprocess
import re

def get_firewall(url):
    command = f'python majorProject/lib/site-packages/wafw00f/main.py {url}'
    try:
        output = subprocess.check_output(command, shell=True, stderr=subprocess.STDOUT, text=True)
    except subprocess.CalledProcessError as e:
        output = f"Error running wafw00f: {e}"
        return output

    strings = output.split('\n')
    response = None        
    for line in strings:
        if '[+]' in line:
            response =  line.strip()
            break

    pattern = r'behind\s+(.*?)\s+WAF'
    match = re.search(pattern, response)

    result = None
    if match:
        result = match.group(1)
        result = '[-] Firewall Detected : ' + result
    
    else:
        result = '[+] Unable to detect firewall.'

    return result
